# generated by datamodel-codegen:
#   filename:  openapi-0.4.0.yaml

from __future__ import annotations

from enum import Enum
from typing import Annotated, Any, Literal

from pydantic import AwareDatetime, BaseModel, ConfigDict, Field

from .Common import IdentifierSafeUnicode, Uuid


class Doc(BaseModel):
    model_config = ConfigDict(
        populate_by_name=True,
    )
    id: Annotated[Uuid, Field(json_schema_extra={"readOnly": True})]
    metadata: dict[str, Any] | None = None
    created_at: Annotated[AwareDatetime, Field(json_schema_extra={"readOnly": True})]
    """
    When this resource was created as UTC date-time
    """
    title: IdentifierSafeUnicode
    """
    Title describing what this document contains
    """
    content: str | list[str]
    """
    Contents of the document
    """


class DocOwner(BaseModel):
    model_config = ConfigDict(
        populate_by_name=True,
    )
    id: Uuid
    role: Role


class DocReference(BaseModel):
    model_config = ConfigDict(
        populate_by_name=True,
    )
    owner: DocOwner
    """
    The owner of this document.
    """
    id: Annotated[Uuid, Field(json_schema_extra={"readOnly": True})]
    """
    ID of the document
    """
    snippet_index: list[int]
    """
    Snippets referred to of the document
    """
    title: str | None = None
    snippet: str | None = None


class DocSearchRequest(BaseModel):
    model_config = ConfigDict(
        populate_by_name=True,
    )
    text: str | list[str] | None = None
    vector: list[float] | list[list[float]] | None = None
    mode: Mode
    """
    The search mode
    """
    confidence: Annotated[float, Field(0.5, ge=0.0, le=1.0)]
    """
    The confidence cutoff level
    """
    alpha: Annotated[float, Field(0.75, ge=0.0, le=1.0)]
    """
    The weight to apply to BM25 vs Vector search results. 0 => pure BM25; 1 => pure vector;
    """
    mmr: bool = False
    """
    Whether to include the MMR algorithm in the search. Optimizes for diversity in search results.
    """
    lang: Literal["en-US"] = "en-US"
    """
    The language to be used for text-only search. Support for other languages coming soon.
    """


class EmbedQueryRequest(BaseModel):
    model_config = ConfigDict(
        populate_by_name=True,
    )
    text: str | list[str]
    """
    Text or texts to embed
    """


class Mode(str, Enum):
    """
    The search mode
    """

    vector = "vector"
    text = "text"
    hybrid = "hybrid"


class Role(str, Enum):
    user = "user"
    agent = "agent"
